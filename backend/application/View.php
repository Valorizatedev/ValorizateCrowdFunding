<?phprequire_once ROOT . 'libs' . DS . 'smarty' . DS . 'libs' . DS . 'Smarty.class.php';class View extends Smarty {    private $_request;    private $_js;    private $_css;    private $_acl;    private $_rutas;    private $_jsPlugin;    private $_cssPlugin;    public function __construct(Request $peticion, ACL $_acl) {        parent::__construct();        $this->_request = $peticion;        $this->_js = array();        $this->_css = array();        $this->_acl = $_acl;        $this->_rutas = array();        $this->_jsPlugin = array();        $this->_cssPlugin = array();        $modulo = $this->_request->getModulo();        $controlador = $this->_request->getControlador();        if ($modulo) {            $this->_rutas['view'] = ROOT . 'modules' . DS . $modulo . DS . 'views' . DS . $controlador . DS;            $this->_rutas['js'] = BASE_URL . 'modules/' . $modulo . '/views/' . $controlador . '/js/';            $this->_rutas['css'] = BASE_URL . 'modules/' . $modulo . '/views/' . $controlador . '/css/';        } else {            $this->_rutas['view'] = ROOT . 'views' . DS . $controlador . DS;            $this->_rutas['js'] = BASE_URL . 'views/' . $controlador . '/js/';            $this->_rutas['css'] = BASE_URL . 'views/' . $controlador . '/css/';        }    }    public function renderizar($vista, $item = false, $noLayout = DEFAULT_LAYOUT) {                       $this->template_dir = ROOT . 'views' . DS . 'layout' . DS . $noLayout . DS;        $this->config_dir = ROOT . 'views' . DS . 'layout' . DS . $noLayout . DS . 'configs' . DS;        $this->cache_dir = ROOT . 'tmp' . DS . 'cache' . DS;        $this->compile_dir = ROOT . 'tmp' . DS . 'template' . DS;        $menuAdmin = array();        $menuCC_CRM = array();        $menuCRM = array();$class='';$classprincipal='';        $menu = array(            array(                'id' => 'inicio',                'titulo' => 'Inicio',				'estilo' => $class,                'enlace' => BASE_URL . 'login/panel',                'imagen' => 'entypo-layout',            )        );        if (Session::get('autenticado')) {               if ($this->_acl->permiso('admin')) {                 if ($this->_acl->permiso('configuracion')) {                    if($item=='config'){                    $class='active';                    $classprincipal='active opened active root-level has-sub';                    }                    $menuAdmin[] = array(                        'id' => 'config',                        'titulo' => 'ConfiguraciÃ³n',                        'estilo' => $class,                        'enlace' => BASE_URL . 'admin/config',                        'imagen' => 'entypo-tools',                    );                $class='';                  }                if ($this->_acl->permiso('ver_rol')) {                    if($item=='rol'){                    $class='active';                    $classprincipal='active opened active root-level has-sub';                    }                    $menuAdmin[] = array(                        'id' => 'rol',                        'titulo' => 'Roles',						'estilo' => $class,                        'enlace' => BASE_URL . 'admin/rol',                        'imagen' => 'entypo-docs',                    );				$class='';	                }					                if ($this->_acl->permiso('ver_tipo_documento')) {                    $menuAdmin[] = array(                        'id' => 'tdocumento',                        'titulo' => 'Tipos de Documento',						'estilo' => $class,                        'enlace' => BASE_URL . 'admin/tdocumento',                        'imagen' => 'entypo-database',                    );                }                if ($this->_acl->permiso('ver_genero')) {                    $menuAdmin[] = array(                        'id' => 'genero',                        'titulo' => 'Generos',						'estilo' => $class,                        'enlace' => BASE_URL . 'admin/genero',                        'imagen' => 'entypo-database',                    );                }                if ($this->_acl->permiso('ver_ciudad')) {					if($item=='ciudad'){					$class='active';					$classprincipal='active opened active root-level has-sub';					}                    $menuAdmin[] = array(                        'id' => 'ciudad',                        'titulo' => 'Ciudades',						'estilo' => $class,                        'enlace' => BASE_URL . 'admin/ciudad',                        'imagen' => 'entypo-database',                    );					$class='';	                }                if ($this->_acl->permiso('ver_departamento')) {				if($item=='departamento'){					$class='active';					$classprincipal='active opened active root-level has-sub';					}                    $menuAdmin[] = array(                        'id' => 'departamento',                        'titulo' => 'Departamentos',						'estilo' => $class,                        'enlace' => BASE_URL . 'admin/departamento',                        'imagen' => 'entypo-database',                    );				$class='';	                }                if ($this->_acl->permiso('ver_usuario')) {				if($item=='usuario'){					$class='active';					$classprincipal='active opened active root-level has-sub';					}                    $menuAdmin[] = array(                        'id' => 'usuario',                        'titulo' => 'Usuarios',						'estilo' => $class,                        'enlace' => BASE_URL . 'admin/usuario',                        'imagen' => 'entypo-user',                    );				$class='';                }                $menu[] = array(                    'id' => 'admin',                    'titulo' => 'Administraci&oacute;n',					'estilo' =>$classprincipal,                    'enlace' => '',                    'imagen' => 'entypo-cog',                    'submenu' => $menuAdmin                );			$classprincipal='';            }					if ($this->_acl->permiso('crm')) {				    if ($this->_acl->permiso('crear_producto')) {				if($item=='producto'){					$class='active';					$classprincipal='active opened active root-level has-sub';					}                    $menuCRM[] = array(                        'id' => 'producto',                        'titulo' => 'Producto',						'estilo' => $class,                        'enlace' => BASE_URL . 'inventario/producto',                        'imagen' => 'entypo-briefcasex'                    );					$class='';	                }                $menu[] = array(                    'id' => 'inventario',                    'titulo' => 'Inventario',					'estilo' =>$classprincipal,                    'enlace' => '',                    'imagen' => 'entypo-shareable',                    'submenu' => $menuCRM                );			$classprincipal='';            }				                  }//        if (!Session::get('autenticado')) {//            $menu[] = array(//                'id' => 'registro',//                'titulo' => 'Registro',//                'enlace' => BASE_URL . 'usuarios/registro',//                'imagen' => 'icon-book',//                'level' => '1'//            );//        }        $_params = array(			'ruta' => BASE_URL . 'views/layout/' . $noLayout . '/',//esto es para la vista del assent            'ruta_css' => BASE_URL . 'views/layout/' . $noLayout . '/css/',            'ruta_img' => BASE_URL . 'views/layout/' . $noLayout . '/img/',            'ruta_js' => BASE_URL . 'views/layout/' . $noLayout . '/js/',            'menu' => $menu,            'item' => $item,            'js' => $this->_js,            'css' => $this->_css,            'css_plugin' => $this->_cssPlugin,            'js_plugin' => $this->_jsPlugin,            'root' => BASE_URL,            'configs' => array(                'app_name' => APP_NAME,                'app_company_name' => APP_COMPANY_NAME,                'app_company_nit' => APP_COMPANY_NIT,                'app_company_web' => APP_COMPANY_WEB            )        );        if (is_readable($this->_rutas['view'] . $vista . '.tpl')) {            /* if ($noLayout) {              $this->template_dir = $this->_rutas['view'];              $this->display($this->_rutas['view'] . $vista . '.tpl');              exit;              } */            $this->assign('_contenido', $this->_rutas['view'] . $vista . '.tpl');        } else {            throw new Exception('Error de vista');        }        $this->assign('_acl', $this->_acl);        $this->assign('_layoutParams', $_params);        $this->display('template.tpl');    }    public function setJs(array $js) {        if (is_array($js) && count($js)) {            for ($i = 0; $i < count($js); $i++) {                $this->_js[] = $this->_rutas['js'] . $js[$i] . '.js';            }        } else {            throw new Exception('Error de js');        }    }    public function setJsPlugin(array $js) {        if (is_array($js) && count($js)) {            for ($i = 0; $i < count($js); $i++) {                $this->_jsPlugin[] = BASE_URL . 'public/js/' . $js[$i] . '.js';            }        } else {            throw new Exception('Error de js plugin');        }    }    public function setCssPlugin(array $css) {        if (is_array($css) && count($css)) {            for ($i = 0; $i < count($css); $i++) {                $this->_cssPlugin[] = BASE_URL . 'public/css/' . $css[$i] . '.css';            }        } else {            throw new Exception('Error de css plugin');        }    }    public function setCss(array $css) {        if (is_array($css) && count($css)) {            for ($i = 0; $i < count($css); $i++) {                $this->_css[] = $this->_rutas['css'] . $css[$i] . '.css';            }        } else {            throw new Exception('Error de css');        }    }}?>